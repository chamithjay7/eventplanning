<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Profile - PG113</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="/js/app.js"></script>
</head>
<body class="container py-5">

<h1 class="mb-4">My Profile</h1>

<div id="profile" class="mb-4"></div>
<div id="msg"></div>

<button id="logoutBtn" class="btn btn-danger">Logout</button>

<script>
    async function loadProfile() {
        try {
            const me = await apiRequest("/api/users/me");
            document.getElementById("profile").innerHTML = `
          <ul class="list-group">
            <li class="list-group-item"><b>ID:</b> ${me.id}</li>
            <li class="list-group-item"><b>Username:</b> ${me.username}</li>
            <li class="list-group-item"><b>Email:</b> ${me.email}</li>
            <li class="list-group-item"><b>Role:</b> ${me.role}</li>
            <li class="list-group-item"><b>Created At:</b> ${me.createdAt}</li>
          </ul>
        `;
        } catch (err) {
            document.getElementById("msg").innerHTML = `<div class="alert alert-danger">Not logged in or token expired.</div>`;
            setTimeout(()=> window.location.href="/login.html", 1500);
        }
    }

    document.getElementById("logoutBtn").addEventListener("click", () => {
        clearToken();
        window.location.href = "/login.html";
    });

    loadProfile();
</script>
</body>
</html>
